!function(h){"use strict";var t=function(e,t){this.ps_active_index=0,this.ps_gallery_items=[],this.active_main_image=0,this.loading_class="--is-loading",this.items=".woocommerce-product-gallery__image",this.cached_galleries={desktop:{},mobile:{}},this.initial_gallery_html={desktop:"",mobile:""},this.$gallery=e,this.$gallery.length&&(this.init=function(){this.options=h.extend({zoom_enabled:void 0!==h.fn.zoom&&"undefined"!=typeof wc_single_product_params&&void 0!==wc_single_product_params.zoom_enabled&&wc_single_product_params.zoom_enabled,ps_enabled:"undefined"!=typeof PhotoSwipe&&("undefined"==typeof wc_single_product_params||void 0===wc_single_product_params.photoswipe_enabled||wc_single_product_params.photoswipe_enabled),quickview:!1,enable_thumbs:h.reyHelpers.params.gallery__enable_thumbs,thumbsLayout:h.reyHelpers.params.active_gallery_type},t||{}),this.$container=this.$gallery.closest("div.product"),this.$items=h(this.items,this.$gallery),this.$form=h("form.variations_form",this.$container),this.isSimpleProduct=0===this.$form.length,this.$attributeFields=h(".variations select",this.$form),this.useVariationAjax="false"===this.$form.attr("data-product_variations"),this.$gallery.length&&(this.initial_gallery_html.desktop=this.$gallery.prop("outerHTML"),this.$items.length?(void 0!==h.fn.wc_product_gallery&&h(".woocommerce-product-gallery").unbind().removeData(),this.chosenAttributes=this.get_chosen_attributes(),this.should_wait_defaults=this.chosenAttributes.count===this.chosenAttributes.chosenCount,this.options.quickview||this.mobileGallery.init(this),this.events(),this.refresh()):this.remove_loading())},this.refresh=function(){var e=this;this.$gallery=h(".woocommerce-product-gallery",this.$container),this.$items=h(this.items,this.$gallery),this.prepare_items();var t=function(){e.options.enable_thumbs&&Object.create(e.galleryThumbs).init(e);h(document).trigger("reycore/woocommerce/gallery_loaded",[e.$gallery,e.$items]),h.reyHelpers.params.gallery__enable_animations&&e.animate_images(e.$gallery),e.remove_loading()};if(!(!this.should_wait_defaults||this.isSimpleProduct))return this.should_wait_defaults=!1,void t();this.$gallery.imagesLoaded(t)},this.add_loading=function(){this.$gallery.addClass(this.loading_class)},this.remove_loading=function(){this.$gallery.removeClass(this.loading_class)},this.events=function(){var s=this;h(document).on("reycore/woocommerce/gallery_loaded",function(e,t,i){var a=h.reyHelpers.params.active_gallery_type;"cascade"===a&&h.reyHelpers.params.cascade_bullets?s.cascadeProductGalleryNav(t,i):"grid"!==a&&"cascade-grid"!==a||t.addClass(i.length%2?"--odd":"--even"),s.addVideoButton()}),this.$form.on("found_variation",function(e,t){s.change_variation_images(t)&&s.prepare_items()}),this.$form.on("click",".reset_variations",function(){s.add_loading(),s.reset_gallery()}),h(document).on("reycore/woocommerce/product_gallery/reset_gallery",function(e,t){if(h.reyHelpers.is_desktop){t||(t=s.initial_gallery_html.desktop);var i=h(t);s.$gallery.html(i.html()),s.refresh()}}),this.$container.on("click",".woocommerce-product-gallery__wrapper > "+this.items+" > a",function(e){if(e.preventDefault(),!h(this).closest(".woocommerce-product-gallery__thumbs").length&&s.options.ps_enabled){var t=h(this).parent().index();s.options.enable_thumbs&&(t=s.ps_active_index),s.product_gallery_open_photoswipe(s.ps_gallery_items,t)}})},this.get_cached_gallery=function(e){var t=this,i=h.reyHelpers.is_desktop?"desktop":"mobile",a=this.cached_galleries[i][e];return!!a&&(this.add_loading(),setTimeout(function(){t.reset_gallery(a)},500),!0)},this.set_cached_gallery=function(e,t){var i=h.reyHelpers.is_desktop?"desktop":"mobile";this.cached_galleries[i][e]=t},this.change_variation_images=function(s){var r=this,i=[];if(this.get_cached_gallery(s.variation_id))r.active_main_image=[s.image_id];else{if(i.push(s.image_id),s.extra_images){var e=s.extra_images.split(",");h.each(e,function(e,t){t!=s.image_id&&i.push(t)})}return 1==i.length&&void 0!==s.parent_product_image_id&&parseInt(s.parent_product_image_id)==i[0]?this.active_main_image[0]!=parseInt(s.parent_product_image_id)&&(this.add_loading(),setTimeout(function(){r.reset_gallery(),r.active_main_image=i},500)):1<(this.active_main_image=i).length?(this.add_loading(),h.ajax({method:"get",url:h.reyHelpers.params.ajaxurl,dataType:"html",data:{action:"rey_frontend_get_extra_variation_images",security:h.reyHelpers.params.ajax_nonce,image_ids:i,type:h.reyHelpers.is_desktop?"desktop":"mobile",product_id:r.$form.attr("data-product_id")||0},error:function(e,t,i){console.error(e),console.error(t),console.error(i)}}).then(function(e,t,i){if("success"!==t)return console.error("Failed request!"),!1;var a=JSON.parse(e)||{data:!1};if(!a.data)return console.error("Empty response!"),!1;r.set_cached_gallery(s.variation_id,a.data),r.reset_gallery(a.data)})):1!=i.length?this.reset_gallery():h.reyHelpers.params.module_extra_variation_images?(h.reyHelpers.is_desktop&&s.gallery_html?t=s.gallery_html:!h.reyHelpers.is_desktop&&s.gallery_html_mobile&&(t=s.gallery_html_mobile),t&&this.reset_gallery(t)):this.remove_loading(),!1;var t}},this.reset_gallery=function(e){h(document).trigger("reycore/woocommerce/product_gallery/reset_gallery",[e])},this.prepare_items=function(){var c=this;this.ps_active_index=0,this.ps_gallery_items=[],this.options.ps_enabled&&h(".woocommerce-product-gallery__trigger",this.$gallery).remove(),this.$items.each(function(e,t){var i=h(t),a=i.children("a"),s=a.children();if(a.attr("data-elementor-open-lightbox","no"),c.options.ps_enabled&&!h(".rey-openBtn",i).length){var r="";void 0!==h.reyCore&&""!==h.reyHelpers.params.js_params.gallery_icon&&(r=h.reyCore.addSvgIcon(h.reyHelpers.params.js_params.gallery_icon,"reycore")),h('<span class="rey-openBtn" title="'+h.reyHelpers.params.wc_open_gallery_text+'">'+r+"</span>").insertAfter(s)}if(s.length&&c.options.ps_enabled){var l=c.ps_gallery_items.map(function(e){return e.src}),o=s.attr("data-large_image")||"";if(0===l.indexOf(o))return;var n={src:o,w:s.attr("data-large_image_width"),h:s.attr("data-large_image_height"),title:s.attr("data-caption")?s.attr("data-caption"):s.attr("title")};c.ps_gallery_items.push(n)}c.make_zoom(i)})},this.make_zoom=function(e){var t=e||this.$items.first(),i=h("a img",t).attr("data-large_image_width"),a=!1;if(!this.options.zoom_enabled||!h.reyHelpers.is_desktop)return t.trigger("zoom.destroy"),!1;if(!this.options.zoom_enabled||!h.reyHelpers.is_desktop)return t.trigger("zoom.destroy"),!1;if(i&&parseInt(i)>this.$gallery.width()&&(a=!0),t.trigger("zoom.destroy"),a){var s=h.extend({touch:!1},wc_single_product_params.zoom_options||{});"ontouchstart"in document.documentElement&&(s.on="click"),s.target&&(s.target=h(s.target,t)),t.zoom(s),t.trigger("woocommerce_gallery_init_zoom")}},this.animate_images=function(e){this.options.quickview&&this.useVariationAjax?h(".--animated-entry",e).addClass("--animated-in"):"undefined"!=typeof ScrollOut?setTimeout(function(){ScrollOut({targets:e[0].querySelectorAll(".--animated-entry"),once:!0,onShown:function(e,t,i){h(e).addClass("--animated-in").css("transition-delay",.05*t.index+"s")}})},10):h(".--animated-entry",e).addClass("--animated-in")},this.get_chosen_attributes=function(){var i={},a=0,s=0;return this.$attributeFields.each(function(){var e=h(this).data("attribute_name")||h(this).attr("name"),t=h(this).val()||"";0<t.length&&s++,a++,i[e]=t}),{count:a,chosenCount:s,data:i}},this.galleryThumbs={init:function(e){this.$pg=e,this.items=this.$pg.items,this.$gallery=this.$pg.$gallery,this.$target=h(this.$pg.$items).first(),this.large_width=h("a img",this.$target).attr("data-large_image_width");this.large_width||(this.large_width=h(".wp-post-image:first-of-type",this.$target).attr("data-large_image_width")),h(".woocommerce-product-gallery__thumbs",this.$gallery).length||(h(this.$pg.$items).filter(":not(:first)").wrapAll('<div class="woocommerce-product-gallery__thumbs"/>'),h(".woocommerce-product-gallery__thumbs .woocommerce-product-gallery__image",this.$gallery).first().addClass("--is-active"),h.reyHelpers.is_desktop&&(this.$thumbsCarousel=Object.create(this._thumbsCarousel),this.$thumbsCarousel.init(this.$gallery,this.$pg.options)),this.addArrowsNav()),this.events()},events:function(){var o=this;this.$pg.$container.on("click",".woocommerce-product-gallery__thumbs "+this.items+" > a",function(e){e.preventDefault();var t=h(e.currentTarget);h(o.items).removeClass("--is-active"),t.parent().addClass("--is-active"),o.$gallery.addClass("--loading-main"),o.$pg.ps_active_index=t.parent().index();var i=t.children("img"),a=h("a > img",o.$target);i.length||(i=h(".wp-post-image",t)),a.length||(a=h("a .wp-post-image",o.$target));var s=i.attr("data-src");o.large_width=i.attr("data-large_image_width"),h("a",o.$target).attr("href",s);var r=function(){o.$gallery.removeClass("--loading-main"),o.$gallery.trigger("reycore/product_gallery/loaded_main_image",[t])},l={src:i.attr("data-preview-src")||s,srcset:i.attr("data-preview-srcset")||"",sizes:i.attr("data-preview-sizes"),title:i.attr("title"),"data-caption":i.attr("data-caption"),"data-large_image":s,"data-src":s,"data-large_image_width":o.large_width,"data-large_image_height":i.attr("data-large_image_height")};a.is("picture")?h("source",a).one("load",r).attr(l):a.one("load",r).attr(l),o.$pg.make_zoom()}),h(window).on("resize",h.reyHelpers.debounce(function(){o.$pg.make_zoom()},300))},addArrowsNav:function(){var l=this;if(h.reyHelpers.params.product_page_gallery_arrows&&1<l.$pg.$items.length){var e=wp.template("reyArrowSvg"),t=e({direction:"left"}),i=e({direction:"right"});h('<div class="rey-mainImage-nav">'+t+i+"</div>").appendTo(this.$target).children().on("click",function(e){e.preventDefault();var t,i=h(this),a=i.hasClass("rey-arrowSvg--left"),s=l.$pg.ps_active_index,r=l.$pg.$items.length-1;i.removeClass("--end"),i.siblings().removeClass("--end"),a?0===(t=0===s?0:s-1)&&i.addClass("--end"):(t=s===r?s:s+1)===r-1&&i.addClass("--end"),l.$thumbsCarousel.$slider?l.$thumbsCarousel.$items.eq(t).children("a").trigger("click"):h(".woocommerce-product-gallery__thumbs:not(.slick-initialized) "+this.items+":nth-child("+(t+1)+") > a").trigger("click")})}},_thumbsCarousel:{vals:{vertical:{size:"height",oSize:"outerHeight"},horizontal:{size:"width",oSize:"outerWidth"}},$slider:!1,init:function(e,t){this.isVertical="vertical"===t.thumbsLayout,this.$gallery=e,this.$tGallery=h(".woocommerce-product-gallery__thumbs",this.$gallery),this.isQuickview=t.thumbsLayout,this.$items=this.$tGallery.children(),this.count=this.$items.length,this.config=this.vals[t.thumbsLayout],this.itemSize=this.$items.first()[this.config.oSize](!0),this.$mainImg=this.$gallery.find(".woocommerce-product-gallery__image img").first(),this.getVars(),this.resizeGallery_customHeight(),this.events(),this.makeCarousel()},getVars:function(){h.reyHelpers.params.product_page_gallery_max_thumbs&&0!=h.reyHelpers.params.product_page_gallery_max_thumbs?this.slidesToShow=parseInt(h.reyHelpers.params.product_page_gallery_max_thumbs):(this.gallerySize=this.$mainImg[this.config.size](),this.slidesToShow=Math.floor(this.gallerySize/this.itemSize))},events:function(){var i=this;this.$gallery.on("reycore/product_gallery/loaded_main_image",function(e,t){i.refresh()}),h(window).on("resize",h.reyHelpers.debounce(function(){i.refresh()},500)),this.$mainImg.on("jetpack-lazy-loaded-image",function(){var e=setInterval(function(){0===i.slidesToShow?(i.refresh(),i.makeCarousel()):clearInterval(e)},500)})},refresh:function(){this.resizeGallery_customHeight(),this.getVars()},resizeGallery_customHeight:function(){if(!this.isQuickview){this.$gallery.closest(".rey-product");var e=h("body").hasClass("--gallery-vertical"),t=h("body").hasClass("--gallery-horizontal");if(h("body.single-skin--fullscreen").length&&(e||t)){var i=h(".woocommerce-product-gallery__wrapper",this.$gallery),a=h("> .woocommerce-product-gallery__image",i),s=h(".woocommerce-product-gallery__thumbs",i);a.css("max-height",""),s.css("max-height","");var r=h("img",a).height();if(!(r<=0)&&(t&&s.length&&(r-=s.outerHeight(!0)),i.css("max-height",i.height()),a.css("max-height",r),s.css("max-height",r),t)){var l=h("img",a).width();s.css("max-width",l)}}}},makeCarousel:function(){if(void 0!==h.reyCore.addSvgIcon&&!this.$slider){var e=this.$items.length>this.slidesToShow,t={dots:!1,infinite:!1,speed:300,rows:0,arrows:!1,slidesToShow:this.slidesToShow};if(e){"edges"===h.reyHelpers.params.product_page_gallery_thumbs_nav_style&&(t.slidesToShow=t.slidesToShow-1);var i=h.reyCore.addSvgIcon("reycore-icon-arrow","reycore"),a='<span class="woocommerce-product-gallery__thumbsPrev">'+i+"</span>",s='<span class="woocommerce-product-gallery__thumbsNext">'+i+"</span>",r=h('<div class="woocommerce-product-gallery__thumbsNav"></div>');t.arrows=!0,t.prevArrow=a,t.nextArrow=s,t.appendArrows=r}this.isVertical?t.vertical=!0:t.variableWidth=!0,0<this.slidesToShow&&void 0!==h.fn.slick&&(this.$slider=this.$tGallery.slick(t),e&&r.appendTo(this.$tGallery))}}}},this.cascadeProductGalleryNav=function(e,i){if(!e.closest(".rey-quickviewPanel").length){e.next(".rey-cascadeNav-wrapper").length&&e.next(".rey-cascadeNav-wrapper").remove();var a='<div class="rey-cascadeNav-wrapper"><div class="rey-cascadeNav">';i.each(function(e,t){a+='<div class="rey-cascadeNav-item '+(0===e?"--active":"")+'" data-index="'+e+'"></div>'});var t,s,r=[],l=h(a+="</div></div>").insertAfter(e),o=h(".rey-cascadeNav-item",l),n=function(e){o.removeClass("--active"),o.eq(e).addClass("--active")},c=function(){t=window.innerHeight/2,i.each(function(e,t){r[e]={top:t.offsetTop,height:t.offsetHeight}}),s=e.height(),l.toggleClass("--hidden",(window.pageYOffset||document.documentElement.scrollTop)+t>s)};c(),h(window).on("resize",h.reyHelpers.debounce(function(){c()},500)).on("scroll",function(){var i=(window.pageYOffset||document.documentElement.scrollTop)+t;h.each(r,function(e,t){i>t.top&&i<t.top+t.height&&n(e)}),l.toggleClass("--hidden",s<i)}),o.on("click",function(e){var t=h(this).attr("data-index");h("html, body").animate({scrollTop:i.eq(t).offset().top},500),n(t)})}},this.addVideoButton=function(){var e=this.$gallery.prevAll(".rey-singlePlayVideo").detach().appendTo(this.$items.eq(0)).removeClass("d-none");void 0!==this.mobileGallery.$mobile_gallery&&e.clone().appendTo(this.mobileGallery.$mobile_gallery)},this.product_gallery_open_photoswipe=function(e,t){if(this.options.ps_enabled&&"undefined"!=typeof PhotoSwipe)if(h.isEmptyObject(e))console.error("Empty array of items");else{var i=h(".pswp");if(i.length){var a=h.extend({index:parseInt(t)||0},wc_single_product_params.photoswipe_options||{});new PhotoSwipe(i[0],PhotoSwipeUI_Default,e,a).init()}}},this.mobileGallery={$mobile_slider:!1,$mobile_thumbs_slider:!1,ps_images:[],use_thumbs:"thumbs"===h.reyHelpers.params.js_params.product_page_mobile_gallery_nav,thumbs_count:h.reyHelpers.params.js_params.product_page_mobile_gallery_nav_thumbs||4,arrows:h.reyHelpers.params.js_params.product_page_mobile_gallery_arrows,use_slider:!0,init:function(e){this.app=e,this.$mobile_gallery=h(".woocommerce-product-gallery__mobile"),this.$mobile_gallery.length&&(this.$images=h("img",this.$mobile_gallery),this.app.initial_gallery_html.mobile=this.$mobile_gallery.prop("outerHTML"),this.use_thumbs&&(this.$mobile_thumbs_gallery=this.$mobile_gallery.clone().attr("class","").addClass("woocommerce-product-gallery__mobile-thumbs").insertBefore(this.app.$gallery),this.use_slider&&this.$mobile_thumbs_gallery.addClass("--slider")),this.events(),this.make_gallery())},events:function(){var i=this;this.$images.on("click",function(e){if(e.preventDefault(),!h.reyHelpers.is_desktop){var t=i.$mobile_slider?i.$mobile_slider.slick("slickCurrentSlide"):0;i.app.product_gallery_open_photoswipe(i.ps_images,t)}}),this.app.$form.on("found_variation",function(e,t){h.reyHelpers.is_desktop||(!0!==h.reyHelpers.params.js_params.scroll_top_after_variation_change||h(this).hasClass("--prevent-scroll-to-gallery")||h("html, body").animate({scrollTop:i.$mobile_gallery.offset().top-15},500),i.$mobile_slider&&i.$mobile_slider.slick("slickGoTo",0),void 0!==t.image.src&&(i.$images.eq(0).attr("src",t.image.src),i.ps_images.length&&(i.ps_images[0].src=t.image.src,i.ps_images[0].w=t.image.src_w,i.ps_images[0].h=t.image.src_h)))}),h(window).on("resize",h.reyHelpers.debounce(function(){!i.$mobile_slider&&1<i.$images.length&&!h.reyHelpers.is_desktop&&i.make_gallery()},500)),h(document).on("reycore/woocommerce/product_gallery/reset_gallery",function(e,t){h.reyHelpers.is_desktop||(i.$mobile_slider&&i.$mobile_slider.slick("unslick"),i.use_thumbs&&i.use_slider&&i.$mobile_thumbs_slider&&i.$mobile_thumbs_slider.slick("unslick"),t||(t=i.app.initial_gallery_html.mobile),i.$mobile_gallery.html(h(t).html()),i.use_thumbs&&i.$mobile_thumbs_gallery.html(h(t).html()),i.make_gallery())})},make_gallery:function(){var r=this;if(!h.reyHelpers.is_desktop){this.$mobile_gallery=h(".woocommerce-product-gallery__mobile"),this.$mobile_thumbs_gallery=this.$mobile_gallery.nextAll(".woocommerce-product-gallery__mobile-thumbs"),this.$images=h("img",this.$mobile_gallery),this.$images.each(function(e,t){var i=h(t),a=JSON.parse(i.attr("data-full")||"{}"),s=i.attr("title")||"";a.length&&r.ps_images.push({src:a[0],w:a[1],h:a[2],title:s})});var e=function(){if(1<r.$images.length){var e={dots:!0,infinite:!0,speed:300,slidesToShow:1,slidesToScroll:1,adaptiveHeight:!0,arrows:r.arrows,rows:0};if(r.arrows){var t=wp.template("reyArrowSvg");e.prevArrow=t({direction:"left"}),e.nextArrow=t({direction:"right"})}if(r.use_thumbs&&r.use_slider&&(e.asNavFor=r.$mobile_thumbs_gallery,e.dots=!1),r.$mobile_slider=r.$mobile_gallery.slick(e),r.use_thumbs&&r.use_slider){var i=e;i.arrows=!1,i.dots=!1,i.slidesToShow=parseFloat(r.thumbs_count),i.adaptiveHeight=!1,i.asNavFor=r.$mobile_gallery,r.$mobile_thumbs_gallery.on("init",function(e,t){h(".slick-slide",t.$slider).on("click",function(e){e.preventDefault();var t=parseFloat(h("img",this).attr("data-index"));r.$mobile_slider.slick("slickGoTo",t-1)})}),r.$mobile_thumbs_slider=r.$mobile_thumbs_gallery.slick(i)}}r.remove_loading()};if(!(!this.app.should_wait_defaults||this.app.isSimpleProduct))return this.should_wait_defaults=!1,void e();this.$mobile_gallery.imagesLoaded(e)}},remove_loading:function(){this.$mobile_gallery.removeClass("--loading")},add_loading:function(){this.$mobile_gallery.addClass("--loading")}},this.init())};h.fn.rey_product_gallery=function(e){return new t(this,e),this},h(document).ready(function(){h("body.single-product .woocommerce-product-gallery").each(function(){h(this).rey_product_gallery()})}),h(document).on("reycore/after_quickview",function(e,t){h(".woocommerce-product-gallery",h(t)).rey_product_gallery({zoom_enabled:!1,ps_enabled:!1,enable_thumbs:!0,thumbsLayout:"vertical",quickview:!0})})}(jQuery);